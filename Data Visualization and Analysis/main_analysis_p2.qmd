---
title: "Main Analysis Part 2"
author: "Luke Fischer"
format: html
editor: visual
---

## Load Packages & Set Seed

```{r}
library(tidyverse)
library(ggplot2)
library(DescTools)
library(broom)
library(knitr)
library(gtExtras)
library(REAT)
library(boot)
library(grafify)
library(binom)
library(RVAideMemoire)

set.seed(7)
```

## General Data Wrangling

```{r}
resat <- read_csv("clean_data.csv")

resat <- resat |> 
  mutate(Time_Stamp = as.factor(Time_Stamp), 
         Attribution_Presence = as.factor(Attribution_Presence), 
         Evaluation = as.factor(Evaluation), 
         Topic = as.factor(Topic), 
         Target = as.factor(Target)) |> 
  mutate(Time_Stamp = fct_recode(Time_Stamp, 
                                 "Before" = "0", 
                                 "After" = "1"), 
         Topic = fct_recode(Topic, 
                            "Economy" = "1", 
                            "Social Policies & Welfare" = "2", 
                            "Politics & Human Rights" = "3", 
                            "External Relations" = "4"), 
         Attribution_Presence = fct_recode(Attribution_Presence, 
                                           "Posts without attribution" = "0",
                                           "Posts with attribution" = "1" 
                                           ), 
         Evaluation = fct_recode(Evaluation, 
                                           "Negative" = "0",
                                           "Positive" = "1" 
         ), 
         Target = fct_recode(Target, 
                             "Individual" = "1", 
                             "Collective" = "2", 
                             "System" = "3", 
                             "Network" = "4")
         )


resat1 <- resat |> 
  mutate(Attribution_Presence = 
           if_else(Sender_Relevance != 1 | is.na(Evaluation) | is.na(Topic), "Posts without attribution", Attribution_Presence))  |> 
  group_by(Post_ID) |> 
  mutate(n = row_number(Attribution_Presence)) |> 
  ungroup() |> 
  filter(n == 1)


resat2 <- resat |> 
  filter(Sender_Relevance == 1 & !is.na(Evaluation) & !is.na(Topic)) 
```

## Setting General Visual Theme

```{r}
theme_set(theme_minimal() + 
            theme(text = element_text(family = "Times New Roman"),
                  legend.text = element_text(size = 12),
                  legend.title = element_text(size = 13),
                  axis.title = element_text(size = 13),
                  axis.text = element_text(size = 15),
                  legend.position = "top"))
```

## RQ1a

**To what extent does the proportion of posts containing responsibility attributions for voting issues vary?**

Cross-Tab:

```{r}
resat1 |> 
  group_by(Time_Stamp) |> 
  count(Attribution_Presence) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Attribution_Presence, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ1a.png", path = '/Users/lukefischer/Desktop')

```

Proportional Indication:

```{r}
resat1 |> 
  group_by(Time_Stamp) |> 
  count(Attribution_Presence) |>
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) 

```

One proportion z - tests

```{r}

prop.test(121, 771, 0.5, alternative = "less")
prop.test(66, 426, 0.5, alternative = "less")

p1a <- c(2.2e-16, 2.2e-16)

p.adjust(p1a, "fdr")
```

Visualization of RQ1a

```{r}
RQ1aplot <- resat1 |> 
  ggplot(aes(x = Time_Stamp, fill = Attribution_Presence)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  coord_flip() + 
  labs(
    x = "Inauguration\n", 
    y = "Proportion", 
    fill = "Post Type"
  )+
  scale_x_discrete(labels = c("Before", "After")) +
  scale_fill_grafify(
    palette = "bright", guide = guide_legend(reverse = TRUE))+
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.9225, 
    label = "15,5%", 
    hjust = "center", 
    size = 3.5
  ) + 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.4225,
    label = "84,5%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.9215,
    label = "15,7%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.4215,
    label = "84,3%", 
    hjust = "center", 
    size = 3.5
  ) +
  theme(plot.title.position = "plot",           
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'), 
        axis.text.y = element_text(angle = 90, hjust = 0.5))

ggsave("RQ1aplot.png", plot = RQ1aplot, path = '/Users/lukefischer/Desktop', width = 8, height= 4, units = "in")

```

## RQ1b

**RQ1b: To what extent does the proportion of responsibility attribution evaluations vary?**

Cross Tab

```{r}
resat2 |> 
  group_by(Time_Stamp) |> 
  count(Evaluation) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Evaluation, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ1b.png", path = '/Users/lukefischer/Desktop')
```

Proportional Indication

```{r}
resat2 |> 
  group_by(Time_Stamp) |> 
  count(Evaluation) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) 


```

One proportion z-tests

```{r}

# Confirmatory
prop.test(61, 129, 0.5, alternative = "greater")
prop.test(27, 69, 0.5, alternative = "greater")


# Exploratory
prop.test(61, 129, 0.5, alternative = "two.sided")
prop.test(27, 69, 0.5, alternative = "two.sided")

p1b<- c(0.5973, 0.09191)

p.adjust(p1b, "fdr")

```

Visualization

```{r}
RQ1bplot <- resat2 |> 
  ggplot(aes(x = Time_Stamp, fill = Evaluation)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  coord_flip() + 
  labs(
    x = "Inauguration\n", 
    y = "Proportion" 
  ) +
  scale_x_discrete(labels = c("Before", "After")) +
  scale_fill_grafify(
    palette = "bright", 
    guide = guide_legend(reverse = TRUE),
    labels = c("Blame", "Credit"))+
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.3045, 
    label = "60,9%", 
    hjust = "center", 
    size = 3.5
  ) + 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.8045,
    label = "39,1%", 
    hjust = "center", 
    size = 3.5
)+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.2635,
    label = "52.7%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.7635,
    label = "47,3%", 
    hjust = "center", 
    size = 3.5
  ) +
  theme(plot.title.position = "plot", 
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'),
        axis.text.y = element_text(angle = 90, hjust = 0.5))

ggsave("RQ1bplot.png", plot = RQ1bplot, path = '/Users/lukefischer/Desktop', width = 8, height= 4, units = "in")

```

## RQ2b

**RQ2b: To what extent does the diversity of individual actor targets of blame attributions for voting issues vary?**

Proportional Indication

```{r}
prop_rq2a <- resat2 |> 
  filter(Evaluation == "Negative" & Target == "Individual") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Individual) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  ungroup()



resat2 |> 
  filter(Evaluation == "Negative" & Target == "Individual") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Individual) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) 

binom.confint(1, 5, conf.level = 0.95, methods = "wilson")

#Before 29
#Afer 5


missing <- tibble(
  Time_Stamp = c("After", "After"), 
  Specific_Individual = c("Hillary Clinton", "Other Individual Republican Politicians"), 
  n = c(0, 0), 
  Proportion = c(0, 0)
)

prop_rq2a <- bind_rows(prop_rq2a, missing) |> 
  mutate(Specific_Individual = as.factor(Specific_Individual)) 
```

Cross Tab

```{r}

prop_rq2a |> 
  select(!Proportion) |> 
  pivot_wider(
    names_from = Specific_Individual, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ2a.png", path = '/Users/lukefischer/Desktop')


```

Visualization

```{r}

RQ2aplot <- resat2 |> 
  filter(Evaluation == "Negative" & Target == "Individual") |> 
  ggplot(aes(x = Time_Stamp, fill = fct_infreq(Specific_Individual))) + 
  geom_bar(position= "dodge",  width = 0.4) +
  scale_fill_grafify(
    palette = "bright",
    labels = 
                        c("Hillary Clinton", "Barack Obama", "Other Dems", "Other", "Other Reps")) +
    labs(
    title = "RQ2a", 
    x = "Inauguration", 
    fill = "Individuals"
  )+
  theme(plot.title.position = "plot", 
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'))
  

ggsave("RQ2aplot.png", plot = RQ2aplot, path = '/Users/lukefischer/Desktop', width = 8, height= 3, units = "in")


```

Gini Coefficient Before & After

```{r}
lorenz_neg_before_ind <- prop_rq2a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_neg_before_ind <- lorenz_neg_before_ind |> 
  pull(n)
  
w_neg_before_ind <- c(1, 1, 1, 0.2, 1)

Gini(gini_neg_before_ind, weights = w_neg_before_ind, conf.level = 0.95, R = 10000)

lorenz_neg_after_ind <- prop_rq2a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_neg_after_ind <- lorenz_neg_after_ind |> 
  pull(n)

w_neg_after_ind <- c(1, 1, 0.2, 1, 1)

Gini(gini_neg_after_ind, weights = w_neg_before_ind, conf.level = 0.95, R = 10000)
```

Lorenz Curves Overlayed

```{r}
lorenz(gini_neg_before_ind, weighting = w_neg_before_ind, lc.col= "violet")

lorenz(gini_neg_after_ind, weighting = w_neg_after_ind, add.lc = TRUE)

```

Replication ELF

```{r}
# Interpretation: probability that two randomly responsibility attributions are about different topics - higher probability means more diversity 

### Function requires Proportion and only before or after
elf <- function(df) {
  df <- df |> mutate(Proportion2 = Proportion^2)
  1 - sum(df$Proportion2)
}

###Custom function in order to bootstrap
elf_boot <- function(df, indices) {
  sample_data <- df[indices, ]
  elf(sample_data)
}


elfrq2a1 <- prop_rq2a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |>
  mutate(n = if_else(Specific_Individual == "Other Individuals", n*(1/5), n)) |> 
  mutate(Proportion = n/sum(n)) |> 
  arrange(n)

elfrq2a1_boot <- boot(data = elfrq2a1, statistic = elf_boot, R=1000)
elfrq2a1_boot
boot.ci(elfrq2a1_boot)


elfrq2a2 <- prop_rq2a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |>
  mutate(n = if_else(Specific_Individual == "Other Individuals", n*(1/5), n)) |> 
  mutate(Proportion = n/sum(n)) |> 
  arrange(n)

elfrq2a2_boot <- boot(data = elfrq2a2, statistic = elf_boot, R=1000)
elfrq2a2_boot
boot.ci(elfrq2a2_boot)
```

## RQ3b

**RQ3b: To what extent does the diversity of individual actor targets of credit attributions for voting issues vary?**

Proportion Indicator

```{r}
prop_rq2b <- resat2 |> 
  filter(Evaluation == "Positive" & Target == "Individual") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Individual) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  ungroup() |> 
  mutate(Specific_Individual = if_else(Specific_Individual == "European politicians and EU politicians (e.g. Ursula Von der Leyen)", "EU/European politician", Specific_Individual))


resat2 |> 
  filter(Evaluation == "Positive" & Target == "Individual") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Individual) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  mutate(Specific_Individual = if_else(Specific_Individual == "European politicians and EU politicians (e.g. Ursula Von der Leyen)", "EU/European politician", Specific_Individual)) 


binom.confint(4, 16, conf.level = 0.95, methods = "wilson")

missing2b <- tibble(
  Time_Stamp = c("Before", "Before", "Before","After", "After"), 
  Specific_Individual = c("Xi Jinping","EU/European politician", "Vladimir Putin", "Hillary Clinton", "Mike Pence"), 
  n = c(0,0, 0, 0, 0), 
  Proportion = c(0,0, 0, 0, 0)
)

prop_rq2b <- bind_rows(prop_rq2b, missing2b) |> 
  mutate(Specific_Individual = as.factor(Specific_Individual)) 
```

Cross Tab

```{r}
prop_rq2b |> 
  select(!Proportion) |> 
  pivot_wider(
    names_from = Specific_Individual, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ2b.png", path = '/Users/lukefischer/Desktop')

```

Visualization

```{r}
RQ2bplot <- resat2 |> 
  mutate(Specific_Individual = if_else(Specific_Individual == "European politicians and EU politicians (e.g. Ursula Von der Leyen)", "EU/European politician", Specific_Individual)) |> 
  filter(Evaluation == "Positive" & Target == "Individual") |> 
  ggplot(aes(x = Time_Stamp, fill = fct_infreq(Specific_Individual))) + 
  geom_bar(position= "dodge",  width = 0.4) +
  scale_fill_grafify(
    palette = "bright")+
    labs(
    title = "RQ2b", 
    x = "Inauguration", 
    fill = "Individuals"
  )+
  theme(plot.title.position = "plot", 
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'))
  

ggsave("RQ2bplot.png", plot = RQ2bplot, path = '/Users/lukefischer/Desktop', width = 10, height= 3, units = "in")

```

Gini Coefficient Before & After

```{r}
lorenz_pos_before_ind <- prop_rq2b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n)

gini_pos_before_ind <- lorenz_pos_before_ind |> 
  pull(n)
  
w_neg_before_ind <- c(1, 1, 1, 1,1, 1, 0.125, 1)

DescTools::Gini(gini_pos_before_ind, weights = w_neg_before_ind, conf.level = 0.95, R = 10000)

lorenz_pos_after_ind <- prop_rq2b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_pos_after_ind <- lorenz_pos_after_ind |> 
  pull(n)

w_neg_after_ind <- c(1, 1, 1, 0.125, 1, 1, 1, 1)

Gini(gini_pos_after_ind, weights = w_neg_after_ind, conf.level = 0.95, R = 10000)
```

Lorenz Curves Overlayed

```{r}


lorenz(gini_pos_before_ind, weighting = w_neg_before_ind, lc.col= "violet")

lorenz(gini_pos_after_ind, weighting = w_neg_after_ind, add.lc = TRUE)


```

Replication ELF

```{r}
elfrq2b1 <- prop_rq2b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  mutate(n = if_else(Specific_Individual == "Other Individuals", n*(1/8), n)) |>
  arrange(n)


elfrq2b_boot <- boot(data =elfrq2b1, statistic = elf_boot, R = 1000)
elfrq2b_boot
boot.ci(elfrq2b_boot)

elfrq2b2 <- prop_rq2b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  mutate(n = if_else(Specific_Individual == "Other Individuals", n*(1/8), n)) |> 
  arrange(n)

elfrq2b2_boot <- boot(data =elfrq2b2, statistic = elf_boot, R = 1000)
elfrq2b2_boot
boot.ci(elfrq2b2_boot)


```

## RQ2c

**To what extent does the diversity of collective actor targets of blame attributions for voting issues vary?**

```{r}
prop_rq3a <- resat2 |> 
  filter(Evaluation == "Negative" & Target == "Collective") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Collective) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  ungroup() |> 
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "Media" = "Media (e.g., Fake News)", 
                                          "Minorities" = "Minority Groups (e.g. Immigrants, Queer People)", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          "Progressives" = "Progressive: Democrats/Liberals/Left-wing ideologists", 
                                          "The Obama-Administration" = "The Obama-Administration", 
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          )) 


resat2 |> 
  filter(Evaluation == "Negative" & Target == "Collective") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Collective) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "Media" = "Media (e.g., Fake News)", 
                                          "Minorities" = "Minority Groups (e.g. Immigrants, Queer People)", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          "Progressives" = "Progressive: Democrats/Liberals/Left-wing ideologists", 
                                          "The Obama-Administration" = "The Obama-Administration", 
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          )) |> 
  summarize(sum(n))


binom.confint(10, 22, conf.level = 0.95, methods = "wilson")

missing3a <- tibble(
  Time_Stamp = c("After", "Before", "Before", "Before"), 
  Specific_Collective = c("Minorities", "National Government Agencies", "USA", "Conservatives"), 
  n = c(0, 0, 0, 0), 
  Proportion = c(0, 0, 0, 0)
)

prop_rq3a <- bind_rows(prop_rq3a, missing3a)
```

Cross Tab

```{r}
prop_rq3a |> 
  select(!Proportion) |> 
  pivot_wider(
    names_from = Specific_Collective, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ3a.png", path = '/Users/lukefischer/Desktop')

```

Data Visualization

```{r}
RQ3aplot <- resat2 |>
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "Media" = "Media (e.g., Fake News)", 
                                          "Minorities" = "Minority Groups (e.g. Immigrants, Queer People)", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          "Progressives" = "Progressive: Democrats/Liberals/Left-wing ideologists", 
                                          "The Obama-Administration" = "The Obama-Administration", 
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          )) |> 
  filter(Evaluation == "Negative" & Target == "Collective") |> 
  ggplot(aes(x = Time_Stamp, fill = fct_infreq(Specific_Collective))) + 
  geom_bar(position= "dodge",  width = 0.4) +
  scale_fill_grafify(
    palette = "bright")+
  labs(
    title = "RQ3a", 
    x = "Inauguration", 
    fill = "Collectives"
  )+
  theme(plot.title.position = "plot", 
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'))


ggsave("RQ3aplot.png", plot = RQ3aplot, path = '/Users/lukefischer/Desktop', width = 10, height= 3, units = "in")
```

Gini Coefficient Before & After

```{r}
lorenz_neg_before_col <- prop_rq3a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_neg_before_col <- lorenz_neg_before_col |> 
  pull(n)
  
w_neg_before_col <- c(1, 1, 1, 1, 1, 1, 1, 0.125)

DescTools::Gini(gini_neg_before_col, weights = w_neg_before_ind, conf.level = 0.95, R = 10000)

lorenz_neg_after_col <- prop_rq3a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_neg_after_col <- lorenz_neg_after_col |> 
  pull(n)

w_neg_after_col <- c(1, 1, 0.125, 1, 1, 1, 1, 1)

DescTools::Gini(gini_neg_after_col, weights = w_neg_after_ind, conf.level = 0.95, R = 10000)
```

Lorenz Curves Overlayed

```{r}

lorenz(gini_neg_before_col,w_neg_before_col, lc.col= "violet")

lorenz(gini_neg_after_col,w_neg_after_col, add.lc = TRUE)
```

ELF Replication

```{r}

elfrq3a1<- prop_rq3a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  mutate(n = if_else(Specific_Collective == "Other Collectives", n*(1/8), n)) |>  
  arrange(n)

elfrq3a1_boot <- boot(elfrq3a1, elf_boot, R = 1000)
boot.ci(elfrq3a1_boot)



elfrq3a2<- prop_rq3a |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  mutate(n = if_else(Specific_Collective == "Other Collectives", n*(1/8), n)) |>  
  arrange(n)

elfrq3a2_boot <- boot(elfrq3a2, elf_boot, R = 1000)
boot.ci(elfrq3a2_boot)
```

## RQ3c

**To what extent does the diversity of collective actor targets of credit attributions for voting issues vary?**

Proportional Indicator

```{r}
prop_rq3b <- resat2 |> 
  filter(Evaluation == "Positive" & Target == "Collective") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Collective) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  ungroup() |> 
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "The Trump-Administration" = "The Trump-Administration", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          )) 

resat2 |> 
  filter(Evaluation == "Positive" & Target == "Collective") |> 
  group_by(Time_Stamp) |> 
  count(Specific_Collective) |> 
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "The Trump-Administration" = "The Trump-Administration", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          )) 

binom.confint(16, 24, conf.level = 0.95, methods = "wilson")



##Before 39
##After 24

missing3b <- tibble(
  Time_Stamp = c("Before", "Before"), 
  Specific_Collective = c("USA", "National Government Agencies"), 
  n = c(0, 0), 
  Proportion = c(0, 0)
)

prop_rq3b <- bind_rows(prop_rq3b, missing3b)
```

Cross-Tab

```{r}
prop_rq3b |> 
  select(!Proportion) |> 
  pivot_wider(
    names_from = Specific_Collective, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ3b.png", path = '/Users/lukefischer/Desktop')

```

Data Visualization

```{r}
RQ3bplot <- resat2 |>
  mutate(Specific_Collective = as.factor(Specific_Collective)) |> 
  mutate(Specific_Collective = fct_recode(Specific_Collective, 
                                          "The Trump-Administration" = "The Trump-Administration", 
                                          "Other Collectives" = "Other Collectives (e.g. Other Countries, Other Political Groups, NGOs, Public Enterprises, International Governing Institutions)", 
                                          
                                          "Conservatives" = "Conservative: Republicans/Right-wing ideologists", 
                                          "National Government Agencies" = "National Government Agencies (e.g., intelligence agencies, government departments like the department of justice)",
                                          "USA" = "USA"
                                          ))  |> 
  filter(Evaluation == "Positive" & Target == "Collective") |> 
  ggplot(aes(x = Time_Stamp, fill = fct_infreq(Specific_Collective))) + 
  geom_bar(position= "dodge",  width = 0.4) +
 scale_fill_grafify(
    palette = "bright")+
  labs(
    title = "RQ3b", 
    x = "Inauguration", 
    fill = "Collectives"
  )+
  theme(plot.title.position = "plot", 
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'))


ggsave("RQ3bplot.png", plot = RQ3bplot, path = '/Users/lukefischer/Desktop', width = 11, height= 3, units = "in")
```

Gini Coefficient Before and After

```{r}
lorenz_pos_before_col <- prop_rq3b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 

gini_pos_before_col <- lorenz_pos_before_col |> 
  pull(n)
  
w_neg_before_ind <- c(1, 1, 1, 0.2, 1)

Gini(gini_pos_before_col, weights = w_neg_before_ind, conf.level = 0.95, R = 10000)

lorenz_pos_after_col <- prop_rq3b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  ungroup() |> 
  arrange(n) |> 
  select(n) 
  
gini_pos_after_col <- lorenz_pos_after_col |> 
  pull(n)

w_neg_after_ind <- c(1, 1, 1, 0.2, 1)

Gini(gini_pos_after_col,weights = w_neg_after_ind, conf.level = 0.95, R = 10000)
```

Lorenz Curves Overlayed

```{r}
lorenz(lorenz_pos_before_col, lc.col= "violet")

lorenz(lorenz_pos_after_col, add.lc = TRUE)
```

ELF Replication

```{r}

elfrq3b1 <- prop_rq3b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  mutate(n = if_else(Specific_Collective == "Other Collectives", n*(1/5), n)) |>
  ungroup() |> 
  arrange(n)

elfrq3b1_boot <- boot(data =elfrq3b1, statistic = elf_boot, R = 1000)
elfrq3b1_boot
boot.ci(elfrq3b1_boot)


elfrq3b2 <- prop_rq3b |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  mutate(n = if_else(Specific_Collective == "Other Collectives", n*(1/5), n)) |> 
  ungroup() |> 
  arrange(n)

elfrq3b2_boot <- boot(data =elfrq3b2, statistic = elf_boot, R = 1000)
elfrq3b2_boot
boot.ci(elfrq3b2_boot)
```

## RQ3a

**To what extent does the proportional distribution of targets for credit attributions vary?**

Proportional Indicator

```{r}
resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Target) |>
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) 

binom.confint(1, 42, conf.level = 0.95, methods = "wilson")



#Before 68

#After 42

```

Cross Tab

```{r}
missing4a <- tibble(
  Time_Stamp = "Before", 
  Target = "Network", 
  n = 0)

complete4a <- resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Target) |> 
  ungroup() 

complete4a<- bind_rows(complete4a, missing4a)

complete4a|> 
  pivot_wider(
    names_from = Target, 
    values_from = n
  )|> 
  gt() |> 
  gtsave("RQ4a.png", path = '/Users/lukefischer/Desktop')
```

Visualization

```{r}
RQ4aplot<- resat2 |> 
  filter(Evaluation == "Positive") |> 
  ggplot(aes(x = Time_Stamp, fill = Target)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  coord_flip()+ 
  labs(
    x = "Inauguration\n", 
    y = "Proportion" 
  ) +
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.0238, 
    label = " 2,3%\neach", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.333314, 
    label = "57,1%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.8095, 
    label = "38,1%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.0145, 
    label = "2,9%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.31617, 
    label = "57,4%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.811411, 
    label = "39,7%", 
    hjust = "center", 
    size = 3.5
  )+
  scale_fill_grafify(palette = "bright", guide = guide_legend(reverse = TRUE))+
  theme(plot.title.position = "plot",           
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'),
        axis.text.y = element_text(angle = 90, hjust = 0.5))

ggsave("RQ4aplot.png", plot = RQ4aplot, path = '/Users/lukefischer/Desktop', width = 8, height= 4, units = "in")
```

## RQ2a

**To what extent does the proportional distribution of targets for blame attributions vary?**

Proportional Indicator

```{r}
resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Target) |>
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) 


```

Cross Tab

```{r}
resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Target) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Target, 
    values_from = n
  )|> 
  gt() |> 
  gtsave("RQ4b.png", path = '/Users/lukefischer/Desktop')
```

Visualization

```{r}
RQ4bplot<- resat2 |> 
  filter(Evaluation == "Negative") |> 
  ggplot(aes(x = Time_Stamp, fill = Target)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  coord_flip()+ 
  labs(
    x = "Inauguration\n", 
    y = "Proportion" 
  ) +
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.4074, 
    label = "81,5%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.9074026, 
    label = "18,5%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.262295, 
    label = "52,5%", 
    hjust = "center", 
    size = 3.5
  )+
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.76229, 
    label = "47.5%", 
    hjust = "center", 
    size = 3.5
  )+
  scale_fill_grafify(palette = "bright", guide = guide_legend(reverse = TRUE))+
  theme(plot.title.position = "plot",           
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'),
        axis.text.y = element_text(angle = 90, hjust = 0.5))

ggsave("RQ4bplot.png", plot = RQ4bplot, path = '/Users/lukefischer/Desktop', width = 8, height= 4, units = "in")
```

## RQ3d

**To what extent does the proportional distribution of voting issues for credit attributions vary?**

Proportional Indicator

```{r}
resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |>
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  mutate(CI_lower = Proportion - 1.96*SE, CI_upper = Proportion + 1.96*SE)


binom.confint(7, 42, conf.level = 0.95, methods = "wilson")

#68 before

#42 after

```

Cross Tab

```{r}
resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Topic, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ5a.png", path = '/Users/lukefischer/Desktop')
```

Data Visualization

```{r}
RQ5aplot <- resat2 |> 
  filter(Evaluation == "Positive") |> 
  ggplot(aes(x = Time_Stamp, fill = Topic)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  coord_flip()+
  labs(
    x = "Inauguration\n", 
    y = "Proportion" 
  ) +
  scale_fill_grafify(palette= "bright", guide = guide_legend(reverse = TRUE)) +
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.0835, 
    label = "16,7%", 
    hjust = "center", 
    size = 3.5
  ) + 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.3455,
    label = "35,7%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.631,
    label = "21,4%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.869,
    label = "26,2%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.03675,
    label = "7,35%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.434,
    label = "72,1%", 
    hjust = "center", 
    size = 3.5
  ) +
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.81655,
    label = "4,41%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.9196,
    label = "16,2%", 
    hjust = "center", 
    size = 3.5
  ) +
  theme(plot.title.position = "plot",           
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'),
        axis.text.y = element_text(angle = 90, hjust = 0.5))

ggsave("RQ5aplot.png", plot = RQ5aplot, path = '/Users/lukefischer/Desktop', width = 9, height= 4, units = "in")
```

Gini Coefficient Before and After

```{r}
lorenz_top_before_pos <- resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "Before") |> 
  count(Topic) |>
  ungroup() |> 
  select(n) |> 
  arrange(n)

gini_top_before_pos<- lorenz_top_before_pos |> 
  pull(n)

Gini(gini_top_before_pos, conf.level = 0.95, R = 10000)

lorenz_top_after_pos <- resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  filter(Time_Stamp == "After") |> 
  count(Topic) |>
  ungroup() |> 
  select(n) |> 
  arrange(n)

gini_top_after_pos<- lorenz_top_after_pos |> 
  pull(n)

Gini(gini_top_after_pos, conf.level = 0.95, R = 10000)


```

Lorenz Curves Overlayed

```{r}
lorenz(lorenz_top_before_pos, lc.col= "violet")

lorenz(lorenz_top_after_pos, add.lc = TRUE)
```

Robustness Check Gini

```{r}
# Interpretation: probability that two randomly responsibility attributions are about different topics - higher probability means more diversity 

### Function requires Proportion and only before or after
elf <- function(df) {
  df <- df |> mutate(Proportion2 = Proportion^2)
  1 - sum(df$Proportion2)
}

###Custom function in order to bootstrap
elf_boot <- function(df, indices) {
  sample_data <- df[indices, ]
  elf(sample_data)
}


rbbefore1 <-resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |>
  mutate(Proportion = n/sum(n)) |> 
  filter(Time_Stamp == "Before") |> 
  ungroup()


factbeforepos <- boot(data = rbbefore1, statistic = elf_boot, R=1000) 
factbeforepos
boot.ci(factbeforepos)


rbafter1 <-resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |>
  mutate(Proportion = n/sum(n)) |> 
  filter(Time_Stamp == "After") |> 
  ungroup()

factafterpos <- boot(data = rbafter1, statistic = elf_boot, R=1000) 
factafterpos
boot.ci(factafterpos)

```

Pairwise Fisher to assess where difference lies

```{r}

pairwise_fisher <- resat2 |> 
  filter(Evaluation == "Positive") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Topic, 
    values_from = n
  ) |> 
  select(!Time_Stamp) |> 
  as.matrix()


fisher.multcomp(pairwise_fisher, p.method = "fdr")


```

## RQ2d

**To what extent does the proportional distribution of voting issues for blame attributions vary?**

Proportional Indicator

```{r}
resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |>
  mutate(Proportion = n/sum(n)) |> 
  mutate(SE = sqrt((Proportion*(1-Proportion))/sum(n))) |> 
  mutate(CI_lower = Proportion - 1.96*SE, CI_upper = Proportion + 1.96*SE) 



binom.confint(7, 27, conf.level = 0.95, methods = "wilson")

#61
#27

```

Cross Tab

```{r}
resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  pivot_wider(
    names_from = Topic, 
    values_from = n
  ) |> 
  gt() |> 
  gtsave("RQ5b.png", path = '/Users/lukefischer/Desktop')
```

Visualization

```{r}
RQ5bplot <- resat2 |> 
  filter(Evaluation == "Negative") |> 
  ggplot(aes(x = Time_Stamp, fill = Topic)) + 
  geom_bar(position= "fill",  width = 0.4) + 
  scale_fill_grafify(palette= "bright", 
                     guide = guide_legend(reverse = TRUE))+ 
  coord_flip()+ 
  labs(
    x = "Inauguration\n", 
    y = "Proportion" 
  ) +
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.1295, 
    label = "25,9%", 
    hjust = "center", 
    size = 3.5
  ) + 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.5555,
    label = "59,3%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.9075,
    label = "11,1%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "After", 
    y = 0.9815,
    label = "3,7%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.09,
    label = "18%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.4835,
    label = "60,7%", 
    hjust = "center", 
    size = 3.5
  ) +
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.81965,
    label = "6,56%", 
    hjust = "center", 
    size = 3.5
  )+ 
  annotate(
    geom = "label", 
    x = "Before", 
    y = 0.9266,
    label = "14,8%", 
    hjust = "center", 
    size = 3.5
  ) +
  theme(plot.title.position = "plot",           
        legend.key.width = unit(1, 'cm'), 
        legend.key.height = unit(0.2, 'cm'),
        axis.text.y = element_text(angle = 90, hjust = 0.5))


ggsave("RQ5bplot.png", plot = RQ5bplot, path = '/Users/lukefischer/Desktop', width = 9, height= 4, units = "in")
```

Gini Coefficient Before and After

```{r}
lorenz_before_neg_top <- resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  filter(Time_Stamp=="Before") |> 
  select(n) |> 
  arrange(n)
  

lorenz_after_neg_top <- resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  filter(Time_Stamp=="After") |> 
  select(n) |> 
  arrange(n)

Gini_before_neg_top <- lorenz_before_neg_top |> 
  pull(n)

Gini_after_neg_top <- lorenz_after_neg_top |> 
  pull(n)

Gini(Gini_before_neg_top, conf.level = 0.95, R = 10000, type = "bca")

Gini(Gini_after_neg_top, conf.level = 0.95, R = 10000, type = "bca")

```

Lorenz Curves Overlayed

```{r}
lorenz(lorenz_before_neg_top,  lc.col= "violet")
lorenz(lorenz_after_neg_top, add.lc = TRUE)
```

Robustness Check Gini (ELF)

```{r}
rbbefore2 <- resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  filter(Time_Stamp=="Before") |> 
  mutate(Proportion = n/sum(n))


factbeforeneg <- boot(data=rbbefore2, statistic = elf_boot, R = 10000)
factbeforeneg
boot.ci(factbeforeneg)

rbafter2 <- resat2 |> 
  filter(Evaluation == "Negative") |> 
  group_by(Time_Stamp) |> 
  count(Topic) |> 
  ungroup() |> 
  filter(Time_Stamp=="After") |> 
  mutate(Proportion = n/sum(n))

factafterneg <- boot(data=rbafter2, statistic = elf_boot, R = 10000)
factbeforeneg
boot.ci(factafterneg)

```

## Reliability Visualizations

```{r}

reliability_table <- tibble(
  Variable =  
    c("RA Presence", "Sender Relevance", "Evaluation", "Presence Individual", "Specific Individual", "Presence Collective", "Specific Collective", "Presence Systems", "Specific Systems", "Presence Network", "Specific Network", "Economy", "Politics & Human Rights", "External Relations", "Social Policies & Welfare"), 
  K_Alpha = 
    c(0.482, 0.5166, 0.6545, 0.7469, 0.7179, 0.4839, 0.5992, 0.1812, 0, 0, 0, 0.7488, 0.2964, 0, 0.7197))

reliability_table <- reliability_table |> 
  mutate(Variable = as.factor(Variable),Variable = fct_reorder(Variable, K_Alpha, .desc = FALSE)) |> 
  arrange(desc(K_Alpha))

reliabilityplot <- reliability_table |> 
  ggplot(aes(x = Variable, y = K_Alpha)) + 
  geom_bar(stat="identity", width = 0.4, fill = "gray") + 
  coord_flip() +
  labs(
    y = "K-Alpha", 
    x = ""
  )+
  annotate(
    geom = "label", 
    x = "Economy", 
    y = 0.7488, 
    label = "0,749", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  ) +
  annotate(
    geom = "label", 
    x = "Presence Individual", 
    y = 0.7469, 
    label = "0,745", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  ) +
  annotate(
    geom = "label", 
    x = "Social Policies & Welfare", 
    y = 0.7197, 
    label = "0,720", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  ) +
  annotate(
    geom = "label", 
    x = "Specific Individual", 
    y = 0.7179, 
    label = "0,718", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  ) +
   annotate(
    geom = "label", 
    x = "Evaluation", 
    y = 0.6545, 
    label = "0,655", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+ 
  annotate(
    geom = "label", 
    x = "Specific Collective", 
    y = 0.5992, 
    label = "0,599", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  annotate(
    geom = "label", 
    x = "Sender Relevance", 
    y = 0.5166, 
    label = "0,517", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  annotate(
    geom = "label", 
    x = "Presence Collective", 
    y = 0.4839, 
    label = "0,484", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  annotate(
    geom = "label", 
    x = "RA Presence", 
    y = 0.4820, 
    label = "0,482", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  annotate(
    geom = "label", 
    x = "Politics & Human Rights", 
    y = 0.2964, 
    label = "0,296", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  annotate(
    geom = "label", 
    x = "Presence Systems", 
    y = 0.1812, 
    label = "0,181", 
    hjust = "left", 
    size = 3.5, 
    label.size = 0, 
    fill = NA
  )+
  theme(plot.title.position = "plot", axis.text = element_text(size = 15)) 



ggsave("reliabilityplot.png", plot = reliabilityplot, path = '/Users/lukefischer/Desktop', width = 11.5, height= 8, units = "in")
```
